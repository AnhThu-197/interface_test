<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Xem thu nhập</title>
    <link rel="stylesheet" href="../../css/main.css" />
    <link rel="stylesheet" href="../../css/Navbar/navbar.css" />
    <link rel="stylesheet" href="../../css/NhanVien/dashboard.css" />
    <link rel="stylesheet" href="../../css/NhanVien/thunhap.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Dancing+Script|Itim|Lobster|Montserrat:500|Noto+Serif|Nunito|Patrick+Hand|Roboto+Mono:100,100i,300,300i,400,400i,500,500i,700,700i|Roboto+Slab|Saira" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  </head>

  <body>
    <header>
      <div class="head2">
        <div>
          <a href="../../trangchu.html">
            <img class="logo-trangchu" src="../../images/logohandmade.jpg" alt="logo" />
          </a>
        </div>
        <div class="head2--list">
          <form action="" id="search-box">
            <buttom class="search-bottom">
              <img width="18" height="18" src="https://img.icons8.com/ios-glyphs/30/search--v1.png" alt="search--v1" />
            </buttom>
            <input id="search-text" type="text" placeholder="Tìm kiếm" />
            <button class="search-bottom">
              <img class="search-bottom-vid" src="../../images/scan-image.gif" alt="" srcset="" />
            </button>
          </form>
          <div id="store">
            <img width="28" height="28" src="https://img.icons8.com/wired/64/online-store.png" alt="online-store" />
            <a href="../HeThongCuaHang.html">
              <p>Hệ thống cửa hàng</p>
            </a>
          </div>
          <div id="news">
            <img width="25" height="25" src="https://img.icons8.com/external-nawicon-detailed-outline-nawicon/64/external-newspaper-communication-nawicon-detailed-outline-nawicon.png" alt="external-newspaper-communication-nawicon-detailed-outline-nawicon" />
            <a href="../../trangchu.html#MAGAZINE">
              <p>Danh mục</p>
            </a>
          </div>
          <div id="login">
            <img width="28" height="28" src="https://img.icons8.com/parakeet-line/48/user-male-circle.png" alt="user-male-circle" />
            <a href="../ThongTinCaNhan.html">
              <p>Nguyễn Văn A</p>
            </a>
            <div class="cart-container">
              <a href="../GioHang.html">
                <img class="cart-icon" width="25" height="25" src="https://img.icons8.com/ios/50/shopping-bag--v1.png" alt="shopping-bag--v1" />
                <span class="cart-badge">0</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </header>

    <main>
      <div class="employee-breadcrumb">
        <a href="../../trangchu.html">Trang chủ</a> &gt;
        <a href="Dashboard.html">Trang nhân viên</a> &gt;
        <span>Xem thu nhập</span>
      </div>

      <div class="employee-container">
        <div class="employee-sidebar">
          <div class="sidebar-header">
            <div class="employee-avatar">
              <img src="../../images/user.jpg" alt="Nguyễn Hoàng Anh Thư" />
            </div>
            <div class="employee-info">
              <h3>Nguyễn Hoàng Anh Thư</h3>
              <p>Nhân viên - Sinh viên UTE</p>
              <span class="employee-id">ID: NV232240</span>
            </div>
          </div>
          
          <div class="sidebar-menu">
            <ul>
              <li>
                <a href="Dashboard.html"><i class="fas fa-home"></i> Tổng quan</a>
              </li>
              <li>
                <a href="DangKyThamGia.html"><i class="fas fa-user-plus"></i> Đăng ký tham gia sản xuất</a>
              </li>
              <li>
                <a href="QuyDinhLamViec.html"><i class="fas fa-book"></i> Quy định làm việc</a>
              </li>
              <li>
                <a href="RutTien.html"><i class="fas fa-hand-holding-usd"></i> Quy trình làm việc</a>
              </li>
              <li>
                <a href="DanhSachDonLam.html"><i class="fas fa-list"></i> Danh sách đơn làm</a>
              </li>
              <li>
                <a href="DangKyDonLam.html"><i class="fas fa-edit"></i> Đăng ký đơn làm</a>
              </li>
              <li>
                <a href="DangKySanPhamMoi.html"><i class="fas fa-plus-circle"></i> Đăng ký sản phẩm mới</a>
              </li>
              <li>
                <a href="NopSanPham.html"><i class="fas fa-upload"></i> Nộp sản phẩm</a>
              </li>
              <li>
                <a href="LichSuSanPham.html"><i class="fas fa-history"></i> Lịch sử sản phẩm nộp</a>
              </li>
              <li>
                <a href="LichSuDonLam.html"><i class="fas fa-clipboard-list"></i> Lịch sử đơn làm</a>
              </li>
              <li class="active">
                <a href="ThuNhap.html"><i class="fas fa-money-bill-wave"></i> Xem thu nhập</a>
              </li>
              <li>
                <a href="LichSuGiaoDich.html"><i class="fas fa-exchange-alt"></i> Lịch sử giao dịch</a>
              </li>
            </ul>
          </div>
        </div>

        <div class="employee-content">
          <div class="page-title">
            <h1>Xem thu nhập</h1>
          </div>

          <div class="income-overview">
            <div class="income-summary">
              <div class="summary-card">
                <div class="summary-icon">
                  <i class="fas fa-wallet"></i>
                </div>
                <div class="summary-content">
                  <h3>2.350.000₫</h3>
                  <p>Ví khả dụng</p>
                </div>
              </div>
              <div class="summary-card">
                <div class="summary-icon pending">
                  <i class="fas fa-hourglass-half"></i>
                </div>
                <div class="summary-content">
                  <h3>1.125.000₫</h3>
                  <p>Chờ duyệt</p>
                </div>
              </div>
              <div class="summary-card">
                <div class="summary-icon total">
                  <i class="fas fa-chart-line"></i>
                </div>
                <div class="summary-content">
                  <h3>16.750.000₫</h3>
                  <p>Tổng thu nhập</p>
                </div>
              </div>
              <div class="summary-card">
                <div class="summary-icon withdraw">
                  <i class="fas fa-hand-holding-usd"></i>
                </div>
                <div class="summary-content">
                  <h3>13.275.000₫</h3>
                  <p>Đã rút</p>
                </div>
              </div>
            </div>

            <div class="action-buttons">
              <button id="withdrawBtn" class="btn btn-primary"><i class="fas fa-money-bill-wave"></i> Rút tiền</button>
              <!-- <a href="LichSuGiaoDich.html" class="btn btn-secondary"><i class="fas fa-history"></i> Lịch sử giao dịch</a> -->
            </div>
          </div>

          <div class="income-sections">
            <div class="income-chart-section">
              <div class="section-header">
                <h2>Thống kê thu nhập</h2>
                <!-- <div class="filter-buttons">
                  <button class="filter-btn active" data-period="month">Tháng</button>
                  <button class="filter-btn" data-period="quarter">Quý</button>
                  <button class="filter-btn" data-period="year">Năm</button>
                </div> -->
              </div>
              <div class="chart-container">
                <div class="chart-placeholder">
                  <div class="chart-bars">
                    <div class="chart-bar">
                      <div class="bar-value" style="height: 60%;" data-value="1.200.000₫"></div>
                      <div class="bar-label">T1</div>
                    </div>
                    <div class="chart-bar">
                      <div class="bar-value" style="height: 75%;" data-value="1.500.000₫"></div>
                      <div class="bar-label">T2</div>
                    </div>
                    <div class="chart-bar">
                      <div class="bar-value" style="height: 45%;" data-value="900.000₫"></div>
                      <div class="bar-label">T3</div>
                    </div>
                    <div class="chart-bar">
                      <div class="bar-value" style="height: 80%;" data-value="1.600.000₫"></div>
                      <div class="bar-label">T4</div>
                    </div>
                    <div class="chart-bar">
                      <div class="bar-value" style="height: 90%;" data-value="1.800.000₫"></div>
                      <div class="bar-label">T5</div>
                    </div>
                    <div class="chart-bar">
                      <div class="bar-value active" style="height: 100%;" data-value="2.000.000₫"></div>
                      <div class="bar-label">T6</div>
                    </div>
                  </div>
                  <div class="chart-info">
                    <div class="info-detail">
                      <span class="info-label">Tháng hiện tại:</span>
                      <span class="info-value">2.000.000₫</span>
                    </div>
                    <div class="info-detail">
                      <span class="info-label">Tăng/giảm:</span>
                      <span class="info-value positive">+11.1% so với tháng trước</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="income-details-section">
              <div class="section-header">
                <h2>Chi tiết thu nhập tháng 6/2023</h2>
              </div>
              <div class="income-details">
                <table>
                  <thead>
                    <tr>
                      <th>Mã đơn</th>
                      <th>Sản phẩm</th>
                      <th>Số lượng</th>
                      <th>Đơn giá</th>
                      <th>Thành tiền</th>
                      <th>Trạng thái</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>DL001</td>
                      <td>
                        <div class="product-info">
                          <img src="../../images/handmade9.jpg" alt="Túi thủ công mỹ nghệ" />
                          <div class="product-name">Túi thủ công mỹ nghệ</div>
                        </div>
                      </td>
                      <td>7</td>
                      <td>70.000₫</td>
                      <td>490.000₫</td>
                      <td><span class="status-badge status-pending">Chờ duyệt</span></td>
                    </tr>
                    <tr>
                      <td>DL003</td>
                      <td>
                        <div class="product-info">
                          <img src="../../images/handmade8.jpg" alt="Thiệp thủ công handmade" />
                          <div class="product-name">Thiệp thủ công handmade</div>
                        </div>
                      </td>
                      <td>12</td>
                      <td>55.000₫</td>
                      <td>660.000₫</td>
                      <td><span class="status-badge status-approved">Đã duyệt</span></td>
                    </tr>
                    <tr>
                      <td>DL004</td>
                      <td>
                        <div class="product-info">
                          <img src="../../images/handmade5.jpg" alt="Móc khóa handmade" />
                          <div class="product-name">Móc khóa handmade</div>
                        </div>
                      </td>
                      <td>21</td>
                      <td>35.000₫</td>
                      <td>735.000₫</td>
                      <td><span class="status-badge status-pending">Chờ duyệt</span></td>
                    </tr>
                    <tr>
                      <td>DL008</td>
                      <td>
                        <div class="product-info">
                          <img src="../../images/handmade3.jpg" alt="Hộp quà handmade" />
                          <div class="product-name">Hộp quà handmade</div>
                        </div>
                      </td>
                      <td>3</td>
                      <td>85.000₫</td>
                      <td>255.000₫</td>
                      <td><span class="status-badge status-approved">Đã duyệt</span></td>
                    </tr>
                  </tbody>
                  <tfoot>
                    <tr>
                      <td colspan="4" class="total-label">Tổng thu nhập:</td>
                      <td colspan="2" class="total-value">2.140.000₫</td>
                    </tr>
                  </tfoot>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal Rút tiền -->
      <div class="withdraw-modal" id="withdrawModal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Rút tiền</h3>
            <button class="close-modal-btn">&times;</button>
          </div>
          <div class="modal-body">
            <div class="balance-info">
              <div class="balance-label">Số dư khả dụng:</div>
              <div class="balance-value">2.350.000₫</div>
            </div>

            <form id="withdrawForm">
              <div class="form-group">
                <label for="withdrawAmount">Số tiền muốn rút:</label>
                <div class="amount-input-wrapper">
                  <input type="number" id="withdrawAmount" min="50000" max="2350000" placeholder="Nhập số tiền" />
                  <span class="currency-symbol">₫</span>
                </div>
                <div class="amount-suggestion">
                  <button type="button" class="amount-btn" data-amount="500000">500.000₫</button>
                  <button type="button" class="amount-btn" data-amount="1000000">1.000.000₫</button>
                  <button type="button" class="amount-btn" data-amount="2000000">2.000.000₫</button>
                  <button type="button" class="amount-btn" data-amount="2350000">Tất cả</button>
                </div>
              </div>

              <div class="form-group">
                <label for="withdrawMethod">Phương thức nhận tiền:</label>
                <select id="withdrawMethod">
                  <option value="">-- Chọn phương thức --</option>
                  <option value="bank">Chuyển khoản ngân hàng</option>
                  <option value="momo">Ví điện tử MoMo</option>
                  <option value="zalopay">Ví điện tử ZaloPay</option>
                  <option value="cash">Tiền mặt tại văn phòng</option>
                </select>
              </div>

              <div class="form-group bank-details" style="display: none;">
                <label for="bankName">Ngân hàng:</label>
                <select id="bankName">
                  <option value="">-- Chọn ngân hàng --</option>
                  <option value="vietcombank">Vietcombank</option>
                  <option value="techcombank">Techcombank</option>
                  <option value="vietinbank">Vietinbank</option>
                  <option value="bidv">BIDV</option>
                  <option value="agribank">Agribank</option>
                  <option value="mbbank">MB Bank</option>
                  <option value="tpbank">TPBank</option>
                  <option value="acb">ACB</option>
                  <option value="vpbank">VPBank</option>
                  <option value="sacombank">Sacombank</option>
                </select>
              </div>

              <div class="form-group bank-details" style="display: none;">
                <label for="accountNumber">Số tài khoản:</label>
                <input type="text" id="accountNumber" placeholder="Nhập số tài khoản" />
              </div>

              <div class="form-group bank-details" style="display: none;">
                <label for="accountName">Tên chủ tài khoản:</label>
                <input type="text" id="accountName" placeholder="Nhập tên chủ tài khoản" />
              </div>

              <div class="form-group e-wallet-details" style="display: none;">
                <label for="phoneNumber">Số điện thoại:</label>
                <input type="text" id="phoneNumber" placeholder="Nhập số điện thoại" />
              </div>

              <div class="form-group">
                <label for="withdrawNote">Ghi chú (không bắt buộc):</label>
                <textarea id="withdrawNote" rows="3" placeholder="Nhập ghi chú nếu có"></textarea>
              </div>
            </form>

            <div class="withdrawal-notes">
              <h4><i class="fas fa-info-circle"></i> Lưu ý:</h4>
              <ul>
                <li>Số tiền tối thiểu cho mỗi lần rút: <strong>50.000₫</strong></li>
                <li>Phí rút tiền: <strong>0₫</strong> (Miễn phí)</li>
                <li>Thời gian xử lý:
                  <ul>
                    <li>Chuyển khoản ngân hàng: 1-2 ngày làm việc</li>
                    <li>Ví điện tử: Trong ngày</li>
                    <li>Tiền mặt: Theo lịch hẹn</li>
                  </ul>
                </li>
                <li>Rút tiền vào cuối tuần hoặc ngày lễ sẽ được xử lý vào ngày làm việc tiếp theo</li>
              </ul>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelWithdrawBtn">Hủy</button>
            <button class="btn btn-primary" id="confirmWithdrawBtn">Xác nhận rút tiền</button>
          </div>
        </div>
      </div>

      <!-- Thông báo kết quả -->
      <div class="result-modal" id="resultModal">
        <div class="modal-content">
          <div class="result-icon success">
            <i class="fas fa-check-circle"></i>
          </div>
          <div class="result-message">
            <h3>Yêu cầu rút tiền thành công!</h3>
            <p>Yêu cầu rút <strong>1.000.000₫</strong> của bạn đã được ghi nhận và đang được xử lý.</p>
            <p>Mã giao dịch: <strong>GD20230615001</strong></p>
          </div>
          <div class="result-actions">
            <button class="btn btn-primary" id="closeResultBtn">Đóng</button>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <div class="item item-1">
        <h4>Follow Us</h4>
        <div class="icon">
          <img src="../../images/logohandmade.jpg" alt="" />
          <br />
          <a href="#"><i class="fa-brands fa-facebook"></i></a>
          <a href="#"><i class="fa-brands fa-twitter"></i></a>
          <a href="#"><i class="fa-brands fa-instagram"></i></a>
          <a href="#"><i class="fa-brands fa-youtube"></i></a>
        </div>
      </div>
      <div class="item">
        <h4>VỀ CHÚNG TÔI</h4>
        <ul>
          <li><a href="#">Câu chuyện thương hiệu</a></li>
          <li><a href="#">Về chúng tôi</a></li>
          <li><a href="#">Liên hệ</a></li>
        </ul>
      </div>
      <div class="item">
        <h4>CHÍNH SÁCH</h4>
        <ul>
          <li><a href="#">Chính sách và quy định chung</a></li>
          <li><a href="#">Chính sách giao nhận thanh toán</a></li>
          <li><a href="#">Chính sách đổi trả sản phẩm</a></li>
        </ul>
      </div>
      <div class="item">
        <h4>MY SHOP</h4>
        <ul>
          <li><a href="#">Quyền lợi thành viên</a></li>
          <li><a href="#">Thông tin thành viên</a></li>
          <li><a href="#">Theo dõi đơn hàng</a></li>
        </ul>
      </div>
    </footer>

    <script src="../../js/utils/dataLoader.js"></script>
    <script src="../../js/utils/productUtils.js"></script>
    <script src="../../js/utils/cart.js"></script>
    <script src="../../js/utils/searchUtils.js"></script>
    <script src="../../js/utils/message.js"></script>
    <script src="../../js/utils/auth.js"></script>
    <script src="../../js/utils/dropdown.js"></script>

    <script>
      // Toggle charts based on period
      const filterButtons = document.querySelectorAll('.filter-btn');
      
      filterButtons.forEach(button => {
        button.addEventListener('click', function() {
          // Remove active class from all buttons
          filterButtons.forEach(btn => {
            btn.classList.remove('active');
          });
          
          // Add active class to clicked button
          this.classList.add('active');
          
          // Get the selected period
          const period = this.getAttribute('data-period');
          
          // In a real application, you would update the chart data here
          console.log('Selected period:', period);
          
          // Simulate changing data for demo purposes
          const chartBars = document.querySelectorAll('.chart-bar');
          
          if (period === 'month') {
            // Monthly data labels
            chartBars.forEach((bar, index) => {
              bar.querySelector('.bar-label').textContent = 'T' + (index + 1);
            });
          } else if (period === 'quarter') {
            // Quarterly data labels
            chartBars.forEach((bar, index) => {
              bar.querySelector('.bar-label').textContent = 'Q' + (index + 1);
            });
          } else if (period === 'year') {
            // Yearly data labels
            chartBars.forEach((bar, index) => {
              bar.querySelector('.bar-label').textContent = (2018 + index);
            });
          }
        });
      });
      
      // Show tooltip on hover
      const chartBars = document.querySelectorAll('.chart-bar');
      
      chartBars.forEach(bar => {
        const barValue = bar.querySelector('.bar-value');
        
        bar.addEventListener('mouseenter', function() {
          const valueText = barValue.getAttribute('data-value');
          
          // Create tooltip
          const tooltip = document.createElement('div');
          tooltip.className = 'chart-tooltip';
          tooltip.textContent = valueText;
          
          // Position tooltip
          bar.appendChild(tooltip);
        });
        
        bar.addEventListener('mouseleave', function() {
          // Remove tooltip
          const tooltip = bar.querySelector('.chart-tooltip');
          if (tooltip) {
            tooltip.remove();
          }
        });
      });
      
      // Handle withdrawal modal
      const withdrawBtn = document.getElementById('withdrawBtn');
      const withdrawModal = document.getElementById('withdrawModal');
      const closeModalBtn = document.querySelector('.close-modal-btn');
      const cancelWithdrawBtn = document.getElementById('cancelWithdrawBtn');
      const confirmWithdrawBtn = document.getElementById('confirmWithdrawBtn');
      const resultModal = document.getElementById('resultModal');
      const closeResultBtn = document.getElementById('closeResultBtn');
      
      // Open withdrawal modal
      withdrawBtn.addEventListener('click', function() {
        withdrawModal.style.display = 'flex';
      });
      
      // Close withdrawal modal
      closeModalBtn.addEventListener('click', function() {
        withdrawModal.style.display = 'none';
      });
      
      cancelWithdrawBtn.addEventListener('click', function() {
        withdrawModal.style.display = 'none';
      });
      
      // Close modal when clicking outside
      window.addEventListener('click', function(event) {
        if (event.target === withdrawModal) {
          withdrawModal.style.display = 'none';
        }
        if (event.target === resultModal) {
          resultModal.style.display = 'none';
        }
      });
      
      // Handle withdrawal method change
      const withdrawMethod = document.getElementById('withdrawMethod');
      const bankDetails = document.querySelectorAll('.bank-details');
      const eWalletDetails = document.querySelectorAll('.e-wallet-details');
      
      withdrawMethod.addEventListener('change', function() {
        const method = this.value;
        
        // Hide all additional fields first
        bankDetails.forEach(field => {
          field.style.display = 'none';
        });
        
        eWalletDetails.forEach(field => {
          field.style.display = 'none';
        });
        
        // Show relevant fields based on selected method
        if (method === 'bank') {
          bankDetails.forEach(field => {
            field.style.display = 'block';
          });
        } else if (method === 'momo' || method === 'zalopay') {
          eWalletDetails.forEach(field => {
            field.style.display = 'block';
          });
        }
      });
      
      // Handle amount suggestion buttons
      const amountButtons = document.querySelectorAll('.amount-btn');
      const withdrawAmount = document.getElementById('withdrawAmount');
      
      amountButtons.forEach(button => {
        button.addEventListener('click', function() {
          const amount = this.getAttribute('data-amount');
          withdrawAmount.value = amount;
        });
      });
      
      // Handle withdrawal confirmation
      confirmWithdrawBtn.addEventListener('click', function() {
        const amount = withdrawAmount.value;
        const method = withdrawMethod.value;
        
        // Validate form
        if (!amount || parseInt(amount) < 50000) {
          alert('Vui lòng nhập số tiền ít nhất 50.000₫');
          return;
        }
        
        if (!method) {
          alert('Vui lòng chọn phương thức nhận tiền');
          return;
        }
        
        if (method === 'bank') {
          const bankName = document.getElementById('bankName').value;
          const accountNumber = document.getElementById('accountNumber').value;
          const accountName = document.getElementById('accountName').value;
          
          if (!bankName || !accountNumber || !accountName) {
            alert('Vui lòng điền đầy đủ thông tin tài khoản ngân hàng');
            return;
          }
        }
        
        if (method === 'momo' || method === 'zalopay') {
          const phoneNumber = document.getElementById('phoneNumber').value;
          
          if (!phoneNumber) {
            alert('Vui lòng nhập số điện thoại');
            return;
          }
        }
        
        // Close withdrawal modal and show success message
        withdrawModal.style.display = 'none';
        
        // Update the success message with the actual amount
        document.querySelector('.result-message p strong').textContent = 
          new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(amount);
        
        // Show result modal
        resultModal.style.display = 'flex';
      });
      
      // Close result modal
      closeResultBtn.addEventListener('click', function() {
        resultModal.style.display = 'none';
      });
    </script>
  </body>
</html> 