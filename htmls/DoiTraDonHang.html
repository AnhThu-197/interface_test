<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Đổi/Trả đơn hàng</title>
    <link rel="stylesheet" href="../css/main.css" />
    <link rel="stylesheet" href="../css/Navbar/navbar.css" />
    <link rel="stylesheet" href="../css/doitradonhang.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Dancing+Script|Itim|Lobster|Montserrat:500|Noto+Serif|Nunito|Patrick+Hand|Roboto+Mono:100,100i,300,300i,400,400i,500,500i,700,700i|Roboto+Slab|Saira" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  </head>

  <body>
    <header>
      <div class="head2">
        <div>
          <a href="../trangchu.html">
            <img class="logo-trangchu" src="../images/logohandmade.jpg" alt="logo" />
          </a>
        </div>
        <div class="head2--list">
          <form action="" id="search-box">
            <buttom class="search-bottom">
              <img width="18" height="18" src="https://img.icons8.com/ios-glyphs/30/search--v1.png" alt="search--v1" />
            </buttom>
            <input id="search-text" type="text" placeholder="Tìm kiếm sản phẩm" />
            <button class="search-bottom">
              <img class="search-bottom-vid" src="../images/scan-image.gif" alt="" srcset="" />
            </button>
          </form>
          <div id="store">
            <img width="28" height="28" src="https://img.icons8.com/wired/64/online-store.png" alt="online-store" />
            <a href="HeThongCuaHang.html">
              <p>Hệ thống cửa hàng</p>
            </a>
          </div>
          <div id="news">
            <img width="25" height="25" src="https://img.icons8.com/external-nawicon-detailed-outline-nawicon/64/external-newspaper-communication-nawicon-detailed-outline-nawicon.png" alt="external-newspaper-communication-nawicon-detailed-outline-nawicon" />
            <a href="#MAGAZINE">
              <p>Danh mục</p>
            </a>
          </div>
          <div id="login">
            <img width="28" height="28" src="https://img.icons8.com/parakeet-line/48/user-male-circle.png" alt="user-male-circle" />
            <a href="Login.html">
              <p>Đăng nhập</p>
            </a>
            <div class="cart-container">
              <a href="GioHang.html">
                <img class="cart-icon" width="25" height="25" src="https://img.icons8.com/ios/50/shopping-bag--v1.png" alt="shopping-bag--v1" />
                <span class="cart-badge">0</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </header>

    <main>
      <div class="order-breadcrumb">
        <a href="../trangchu.html">Trang chủ</a> &gt;
        <a href="ThongTinCaNhan.html">Tài khoản</a> &gt;
        <a href="DonHang.html">Đơn hàng của tôi</a> &gt;
        <a href="ChiTietDonHang.html">Chi tiết đơn hàng</a> &gt;
        <span>Yêu cầu đổi/trả đơn hàng</span>
      </div>

      <div class="return-container">
        <div class="return-header">
          <div class="header-icon">
            <i class="fas fa-exchange-alt"></i>
          </div>
          <div class="header-content">
            <h1>Yêu cầu đổi/trả đơn hàng #ORD-123456</h1>
            <p class="header-desc">Vui lòng chọn sản phẩm và cung cấp thông tin để yêu cầu đổi/trả hàng.</p>
          </div>
        </div>

        <div class="return-content">
          <div class="return-policy">
            <div class="policy-header">
              <h2>Chính sách đổi trả</h2>
            </div>
            <div class="policy-content">
              <div class="policy-item">
                <div class="policy-icon"><i class="fas fa-calendar-alt"></i></div>
                <div class="policy-text">
                  <h3>Thời gian đổi trả</h3>
                  <p>7 ngày kể từ khi nhận hàng</p>
                </div>
              </div>
              <div class="policy-item">
                <div class="policy-icon"><i class="fas fa-box-open"></i></div>
                <div class="policy-text">
                  <h3>Điều kiện sản phẩm</h3>
                  <p>Còn nguyên tem, nhãn, chưa qua sử dụng</p>
                </div>
              </div>
              <div class="policy-item">
                <div class="policy-icon"><i class="fas fa-shipping-fast"></i></div>
                <div class="policy-text">
                  <h3>Phí vận chuyển</h3>
                  <p>Miễn phí nếu lỗi do nhà bán, khách hàng chịu phí trong trường hợp khác</p>
                </div>
              </div>
              <a href="#" class="policy-full-link">Xem đầy đủ chính sách đổi trả <i class="fas fa-arrow-right"></i></a>
            </div>
          </div>

          <div class="return-form">
            <form id="returnOrderForm">
              <div class="form-section">
                <h2>1. Chọn sản phẩm muốn đổi/trả <span class="required">*</span></h2>
                <div class="product-selection">
                  <div class="product-item">
                    <div class="product-select">
                      <input type="checkbox" id="product1" name="return_products[]" value="product1" />
                    </div>
                    <div class="product-info">
                      <img src="../images/handmade3.jpg" alt="Sản phẩm 1" class="product-img" />
                  <div class="product-info">
                    <div class="product-name">Hộp Đèn Chiếu "Mơ Mộng"</div>
                        <div class="product-variant">Màu: Nâu / Size: M</div>
                        <div class="product-price">350.000₫ x 2</div>
                      </div>
                    </div>
                    <div class="product-quantity">
                      <label for="quantity1">Số lượng:</label>
                      <select id="quantity1" name="quantity1" disabled>
                        <option value="1">1</option>
                        <option value="2" selected>2</option>
                      </select>
                    </div>
                  </div>

                  <div class="product-item">
                    <div class="product-select">
                      <input type="checkbox" id="product2" name="return_products[]" value="product2" />
                    </div>
                    <div class="product-info">
                      <img src="../images/handmade7.jpg" alt="Sản phẩm 2" class="product-img" />
                  <div class="product-info">
                    <div class="product-name">Bộ Chai Nghệ Thuật "Hương Sắc Thiên Nhiên"</div>
                        <div class="product-variant">Màu: Đen</div>
                        <div class="product-price">250.000₫ x 1</div>
                      </div>
                    </div>
                    <div class="product-quantity">
                      <label for="quantity2">Số lượng:</label>
                      <select id="quantity2" name="quantity2" disabled>
                        <option value="1" selected>1</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-section">
                <h2>2. Loại yêu cầu <span class="required">*</span></h2>
                <div class="request-type">
                  <div class="radio-option">
                    <input type="radio" id="typeReturn" name="requestType" value="return" checked />
                    <label for="typeReturn">Trả hàng & hoàn tiền</label>
                  </div>
                  <div class="radio-option">
                    <input type="radio" id="typeExchange" name="requestType" value="exchange" />
                    <label for="typeExchange">Đổi sản phẩm khác</label>
                  </div>
                </div>

                <div id="exchangeOptions" style="display: none;">
                  <h3>Thông tin sản phẩm muốn đổi</h3>
                  <p class="form-note">Vui lòng cung cấp thông tin sản phẩm bạn muốn đổi</p>
                  
                  <div class="exchange-fields">
                    <div class="form-group">
                      <label for="exchangeProduct">Tên sản phẩm muốn đổi</label>
                      <input type="text" id="exchangeProduct" name="exchangeProduct" placeholder="Nhập tên sản phẩm..." />
                    </div>
                    <div class="form-row">
                      <div class="form-group">
                        <label for="exchangeColor">Màu sắc</label>
                        <input type="text" id="exchangeColor" name="exchangeColor" placeholder="Ví dụ: Đen, Nâu..." />
                      </div>
                      <div class="form-group">
                        <label for="exchangeSize">Kích thước</label>
                        <input type="text" id="exchangeSize" name="exchangeSize" placeholder="Ví dụ: S, M, L..." />
                      </div>
                    </div>
                    <div class="form-group">
                      <label for="exchangeNote">Ghi chú thêm</label>
                      <textarea id="exchangeNote" name="exchangeNote" rows="3" placeholder="Thông tin bổ sung về sản phẩm muốn đổi..."></textarea>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-section">
                <h2>3. Lý do đổi/trả <span class="required">*</span></h2>
                <div class="return-reason">
                  <div class="radio-options">
                    <div class="radio-option">
                      <input type="radio" id="reason1" name="returnReason" value="Sản phẩm bị lỗi/hỏng" />
                      <label for="reason1">Sản phẩm bị lỗi/hỏng</label>
                    </div>
                    <div class="radio-option">
                      <input type="radio" id="reason2" name="returnReason" value="Sản phẩm không đúng mô tả" />
                      <label for="reason2">Sản phẩm không đúng mô tả</label>
                    </div>
                    <div class="radio-option">
                      <input type="radio" id="reason3" name="returnReason" value="Sản phẩm không vừa size" />
                      <label for="reason3">Sản phẩm không vừa size</label>
                    </div>
                    <div class="radio-option">
                      <input type="radio" id="reason4" name="returnReason" value="Sai màu sắc/kiểu dáng" />
                      <label for="reason4">Sai màu sắc/kiểu dáng</label>
                    </div>
                    <div class="radio-option">
                      <input type="radio" id="reason5" name="returnReason" value="Nhận sai sản phẩm đã đặt" />
                      <label for="reason5">Nhận sai sản phẩm đã đặt</label>
                    </div>
                    <div class="radio-option">
                      <input type="radio" id="reason6" name="returnReason" value="other" />
                      <label for="reason6">Lý do khác</label>
                    </div>
                  </div>

                  <div class="form-group" id="otherReasonGroup" style="display: none;">
                    <label for="otherReason">Vui lòng cho biết lý do khác:</label>
                    <textarea id="otherReason" name="otherReason" rows="4" placeholder="Nhập lý do của bạn..."></textarea>
                  </div>

                  <div class="form-group">
                    <label for="reasonDetail">Mô tả chi tiết vấn đề (bắt buộc):</label>
                    <textarea id="reasonDetail" name="reasonDetail" rows="4" placeholder="Vui lòng mô tả chi tiết vấn đề bạn gặp phải với sản phẩm..."></textarea>
                  </div>
                </div>
              </div>

              <div class="form-section">
                <h2>4. Bằng chứng (ảnh)</h2>
                <p class="form-note">Vui lòng cung cấp hình ảnh làm bằng chứng để chúng tôi xử lý yêu cầu nhanh chóng hơn</p>
                
                <div class="photo-upload">
                  <div class="upload-area">
                    <input type="file" id="returnPhotos" name="returnPhotos[]" multiple accept="image/*" />
                    <label for="returnPhotos" class="upload-label">
                      <i class="fas fa-cloud-upload-alt"></i>
                      <span>Kéo thả ảnh vào đây hoặc nhấp để tải lên</span>
                      <small>Tối đa 5 ảnh, mỗi ảnh không quá 5MB</small>
                    </label>
                  </div>
                  <div class="preview-photos" id="photoPreview"></div>
                </div>
              </div>

              <div class="form-section">
                <h2>5. Phương thức hoàn tiền (nếu trả hàng)</h2>
                <div class="refund-method">
                  <div class="radio-options">
                    <div class="radio-option">
                      <input type="radio" id="refundMethod1" name="refundMethod" value="original" checked />
                      <label for="refundMethod1">Hoàn tiền theo phương thức thanh toán ban đầu</label>
                    </div>
                    <div class="radio-option">
                      <input type="radio" id="refundMethod2" name="refundMethod" value="bank" />
                      <label for="refundMethod2">Chuyển khoản ngân hàng</label>
                    </div>
                  </div>

                  <div id="bankDetails" style="display: none;">
                    <div class="form-row">
                      <div class="form-group">
                        <label for="bankName">Tên ngân hàng</label>
                        <input type="text" id="bankName" name="bankName" placeholder="Ví dụ: Vietcombank, BIDV..." />
                      </div>
                      <div class="form-group">
                        <label for="accountNumber">Số tài khoản</label>
                        <input type="text" id="accountNumber" name="accountNumber" placeholder="Nhập số tài khoản" />
                      </div>
                    </div>
                    <div class="form-group">
                      <label for="accountHolder">Tên chủ tài khoản</label>
                      <input type="text" id="accountHolder" name="accountHolder" placeholder="Nhập tên chủ tài khoản" />
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-notice">
                <i class="fas fa-info-circle"></i>
                <p>
                  Lưu ý: Sau khi gửi yêu cầu đổi/trả, chúng tôi sẽ tiến hành xem xét trong vòng 24 giờ làm việc. 
                  Bạn sẽ nhận được email xác nhận và hướng dẫn gửi hàng về cho chúng tôi. Thời gian hoàn tiền 
                  sẽ mất từ 7-14 ngày làm việc sau khi chúng tôi nhận được hàng trả lại.
                </p>
              </div>

              <div class="form-actions">
                <a href="ChiTietDonHang.html" class="btn btn-back">Quay lại</a>
                <button type="submit" class="btn btn-submit">Gửi yêu cầu đổi/trả</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <div class="return-confirmation-modal" id="confirmationModal">
        <div class="modal-content">
          <div class="modal-header">
            <i class="fas fa-check-circle"></i>
            <h3>Yêu cầu đổi/trả đã được gửi</h3>
            <button class="close-modal-btn">&times;</button>
          </div>
          <div class="modal-body">
            <p>Yêu cầu đổi/trả đơn hàng #ORD-123456 của bạn đã được gửi đi thành công.</p>
            <p>Chúng tôi sẽ xem xét yêu cầu của bạn trong vòng 24 giờ và gửi email xác nhận cùng hướng dẫn gửi hàng.</p>
            <p>Cảm ơn bạn đã mua sắm cùng chúng tôi!</p>
            
            <div class="modal-actions">
              <a href="DonHang.html" class="btn btn-primary">Xem đơn hàng của tôi</a>
              <a href="../trangchu.html" class="btn btn-secondary">Tiếp tục mua sắm</a>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <div class="item item-1">
        <h4>Follow Us</h4>
        <div class="icon">
          <img src="../images/logohandmade.jpg" alt="" />
          <br />
          <a href="#"><i class="fa-brands fa-facebook"></i></a>
          <a href="#"><i class="fa-brands fa-twitter"></i></a>
          <a href="#"><i class="fa-brands fa-instagram"></i></a>
          <a href="#"><i class="fa-brands fa-youtube"></i></a>
        </div>
      </div>
      <div class="item">
        <h4>VỀ CHÚNG TÔI</h4>
        <ul>
          <li><a href="#">Câu chuyện thương hiệu</a></li>
          <li><a href="#">Về chúng tôi</a></li>
          <li><a href="#">Liên hệ</a></li>
        </ul>
      </div>
      <div class="item">
        <h4>CHÍNH SÁCH</h4>
        <ul>
          <li><a href="#">Chính sách và quy định chung</a></li>
          <li><a href="#">Chính sách giao nhận thanh toán</a></li>
          <li><a href="#">Chính sách đổi trả sản phẩm</a></li>
        </ul>
      </div>
      <div class="item">
        <h4>MY SHOP</h4>
        <ul>
          <li><a href="#">Quyền lợi thành viên</a></li>
          <li><a href="#">Thông tin thành viên</a></li>
          <li><a href="#">Theo dõi đơn hàng</a></li>
        </ul>
      </div>
    </footer>

    <script src="../js/utils/dataLoader.js"></script>
    <script src="../js/utils/productUtils.js"></script>
    <script src="../js/utils/cart.js"></script>
    <script src="../js/utils/searchUtils.js"></script>
    <script src="../js/utils/message.js"></script>
    <script src="../js/utils/auth.js"></script>
    <script src="../js/utils/dropdown.js"></script>
    <script>
      // Show/hide the "other reason" textarea based on selection
      document.querySelectorAll('input[name="returnReason"]').forEach(radio => {
        radio.addEventListener('change', function() {
          const otherReasonGroup = document.getElementById('otherReasonGroup');
          if (this.value === 'other') {
            otherReasonGroup.style.display = 'block';
          } else {
            otherReasonGroup.style.display = 'none';
          }
        });
      });

      // Toggle exchange options based on request type
      document.querySelectorAll('input[name="requestType"]').forEach(radio => {
        radio.addEventListener('change', function() {
          const exchangeOptions = document.getElementById('exchangeOptions');
          if (this.value === 'exchange') {
            exchangeOptions.style.display = 'block';
          } else {
            exchangeOptions.style.display = 'none';
          }
        });
      });

      // Toggle bank details based on refund method
      document.querySelectorAll('input[name="refundMethod"]').forEach(radio => {
        radio.addEventListener('change', function() {
          const bankDetails = document.getElementById('bankDetails');
          if (this.value === 'bank') {
            bankDetails.style.display = 'block';
          } else {
            bankDetails.style.display = 'none';
          }
        });
      });

      // Enable/disable quantity dropdown based on product selection
      document.querySelectorAll('input[name="return_products[]"]').forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          const productId = this.id;
          const quantitySelect = document.getElementById('quantity' + productId.substring(7));
          quantitySelect.disabled = !this.checked;
        });
      });

      // Photo preview functionality
      document.getElementById('returnPhotos').addEventListener('change', function(e) {
        const photoPreview = document.getElementById('photoPreview');
        photoPreview.innerHTML = '';
        
        const files = e.target.files;
        for (let i = 0; i < Math.min(files.length, 5); i++) {
          const file = files[i];
          
          const reader = new FileReader();
          reader.onload = function(e) {
            const preview = document.createElement('div');
            preview.className = 'preview-item';
            
            const img = document.createElement('img');
            img.src = e.target.result;
            img.alt = file.name;
            
            const removeBtn = document.createElement('button');
            removeBtn.className = 'remove-photo-btn';
            removeBtn.innerHTML = '<i class="fas fa-times"></i>';
            removeBtn.type = 'button';
            
            preview.appendChild(img);
            preview.appendChild(removeBtn);
            photoPreview.appendChild(preview);
          };
          
          reader.readAsDataURL(file);
        }
      });

      // Form submission
      document.getElementById('returnOrderForm').addEventListener('submit', function(e) {
        e.preventDefault();
        document.getElementById('confirmationModal').style.display = 'flex';
      });

      // Close modal
      document.querySelector('.close-modal-btn').addEventListener('click', function() {
        document.getElementById('confirmationModal').style.display = 'none';
      });
    </script>
  </body>
</html> 